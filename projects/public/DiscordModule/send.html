<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Discord WebHook</title>
	</head>
	<body>
		<script>
			function getURLvar(url) {
			  var queryString = url ? url.split('?')[1] : window.location.search.slice(1);
			  var obj = {};
			  if (queryString) {
				queryString = queryString.split('#')[0];
				var arr = queryString.split('&');
				for (var i = 0; i < arr.length; i++) {
				  var a = arr[i].split('=');
				  var paramNum = undefined;
				  var paramName = a[0].replace(/\[\d*\]/, function(v) {
					paramNum = v.slice(1,-1);
					return '';
				  });
				  var paramValue = typeof(a[1])==='undefined' ? true : a[1];
				  paramName = paramName.toLowerCase();
				  paramValue = paramValue.toLowerCase();

				  if (obj[paramName]) {
					if (typeof obj[paramName] === 'string') {
					  obj[paramName] = [obj[paramName]];
					}
					if (typeof paramNum === 'undefined') {
					  obj[paramName].push(paramValue);
					} else {
					  obj[paramName][paramNum] = paramValue;
					}
				  } else {
					obj[paramName] = paramValue;
				  }
				}
			  }
			  return obj;
			}
			var url = window.location.href;
			url = decodeURIComponent(url);
			
			var serv = getURLvar(url).serv;
			var tok	 = getURLvar(url).token;
			var code = getURLvar(url).code;
			var text = getURLvar(url).content;
			var name = getURLvar(url).name;
			text = text.charAt(0).toUpperCase() + text.slice(1);
			name = name.charAt(0).toUpperCase() + name.slice(1);

			len = tok.length;
			var codeArr = code.split("|");
			codeArr.forEach(function(v) {
				var pos = Number(v);
				tok = tok.substr(0, pos) + tok.charAt(pos).toUpperCase() + tok.slice(pos+1);
			});
			
			var link = "https://discordapp.com/api/webhooks/" + serv + "/" + tok;
			
			var xhr = new XMLHttpRequest();
			xhr.open("POST", link, true);
			xhr.setRequestHeader("Content-Type", "application/json; charset=utf-8");
			var data = JSON.stringify({"content":text, "username":name});
			xhr.send(data);
		</script>
	</body>
</html>
